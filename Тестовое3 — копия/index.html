<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Microsoft header</title>
    <link rel="SHORTCUT ICON" href="https://c.s-microsoft.com/favicon.ico?v2" type="image/x-icon">
</head>
<body>

    <header class="">
        <div class="wrapper">
            <button class="header__burger-open">

            </button>

            <button class="header__search-mobile"></button>

            <a href="#" class="header__logo">
                <img src="https://img-prod-cms-rt-microsoft-com.akamaized.net/cms/api/am/imageFileData/RE1Mu3b?ver=5c31" alt="img">
            </a>

            <div class="header__pagename"><a href="#"><span>Surface</span></a></div>

            <nav class="header__navigation header__navigation-left">
                <ul class="header__navigation_list">
                    <li class="navigation_list_item has-child"><a href="#"><span>Computers</span></a></li>
                    <li class="navigation_list_item has-child"><a href="#"><span>Computers for Business</span></a></li>
                    <li class="navigation_list_item has-child"><a href="#"><span>Accessories</span></a></li>
                    <li class="navigation_list_item has-child"><a href="#"><span>Shop now</span></a></li>
                    <li class="navigation_list_item header__support"><a href="#"><span>Support</span></a></li>
                    <li id="navigation_more-list">
                        <button class="more-list_open-btn"><span>More</span></button>
                        <ul class="more-list_container" style="position: absolute; opacity: 0; visibility: hidden; pointer-events: none;"></ul>
                    </li>
                </ul>
            </nav>

            <nav class="header__navigation header__navigation-right">
                <ul class="header__navigation_list">
                    <li class="navigation_list_item has-child header__all-microsoft"><a href="#"><span>All Microsoft</span></a></li>
                    <li class="navigation_list_item header__search"><a href="#"><span>Search</span><span class="tip">Search Microsoft.com</span></a></li>
                    <li class="navigation_list_item header__cart"><a href="#"><span>Cart</span><span class="tip">0 items in shopping cart</span></a></li>
                    <li class="navigation_list_item header__sign-in"><a href="#">
                        <span>Sign in</span>
                        <svg xmlns="http://www.w3.org/2000/svg"width="32" height="32" viewBox="0 0 64 64" stroke="#707070"><g class="mectrl_stroke" stroke-width="1.9" fill="none"><circle cx="32" cy="32" r="30.25"/><g transform="matrix(1.1 0 0 1.1 8.8 5.61)"><circle class="mectrl_stroke" cx="20" cy="16" r="7"/><path class="mectrl_stroke" d="M30 35h10m-5-5v10M30.833 32.09A11 11 0 009 34"/></g></g></svg>
                    </a></li>
                </ul>
            </nav>

            <div class="header__search-blk">
                <button class="header__search_close-mobile"></button>

                <div class="header__search-group">
                    <input placeholder="Search Microsoft.com" type="search" name="search bar" id="searchBar" class="header__search_input">
                    <button class="header__search_search-btn"><span class="tip">Search Microsoft.com</span></button>
                </div>

                <button class="header__search_close">Cancel</button>
            </div>
        </div>
        <div class="header__pagename-mobile">
            <button class="header__pagename-mobile_text">Surface</button>
            <span class="header__pagename-mobile_ico"></span>
        </div>

        <div class="header__burger-menu">
            <ul class="burger-menu_list">
                <li class="burger-menu_item"><a href="#">Microsoft 365</a></li>
                <li class="burger-menu_item"><a href="#">Office</a></li>
                <li class="burger-menu_item"><a href="#">Windows</a></li>
                <li class="burger-menu_item"><a href="#">Surface</a></li>
                <li class="burger-menu_item"><a href="#">Xbox</a></li>
                <li class="burger-menu_item"><a href="#">Deals</a></li>
                <li class="burger-menu_item"><a href="#">Support</a></li>
                <li class="burger-menu_item has-child"><a href="#">Software</a></li>
                <li class="burger-menu_item has-child"><a href="#">PCs & Devices</a></li>
                <li class="burger-menu_item has-child"><a href="#">Entertainment</a></li>
                <li class="burger-menu_item has-child"><a href="#">Business</a></li>
                <li class="burger-menu_item has-child"><a href="#">Developer & IT</a></li>
                <li class="burger-menu_item has-child"><a href="#">Other</a></li>
                <li class="burger-menu_item"><a href="#">View Sitemap</a></li>
            </ul>
        </div>
    </header>
    
</body>
</html>

<style>
    @font-face{font-family:"MWF-MDL2";src:url("https://www.microsoft.com/mwf/_h/v3.54/mwf.app/fonts/mwfmdl2-v3.54.woff") format("woff"),url("https://www.microsoft.com/mwf/_h/v3.54/mwf.app/fonts/mwfmdl2-v3.54.ttf") format("truetype"),url("https://www.microsoft.com/mwf/_h/v3.54/mwf.app/fonts/mwfmdl2-v3.54.svg") format("svg")}

body{
    margin: 0;
    font-family: 'Segoe UI',SegoeUI,"Helvetica Neue",Helvetica,Arial,sans-serif;
    min-height: 110vw;
    background: #ebfaff;
}

button{
    border: 0;
    background: 0;
    border-radius: 0;
    cursor: pointer;
}

*{
    box-sizing: border-box;
}

*:focus, *:active{
    border: 0;
}

a{
    text-decoration: none;
    color: #000;
}

ul{
    list-style: none;
    padding: 0;
    margin: 0;
}

.wrapper{
    max-width: 1605px;
    height: 100%;
    margin: 0 auto;
    padding-top: 1px;
}

header{
    background: #fff;
    padding: 0 5%;
}

header a span{
    position: relative;
}

header a:hover span::before{
    content: "";
    width: 100%;
    height: 2px;
    background: #000;
    position: absolute;
    top: calc(100% + 2px);
    left: 0;
}

header .wrapper{
    display: flex;
}

.header__logo{
    padding: 17px 6px 16px 21px;
    height: 100%;
    margin-top: 1px;
    outline-offset: -2px;
    width: fit-content;
    width: -moz-fit-content;
}

.header__logo img{
    margin-top: -3px;
    max-width: none;
    width: 108px;
}

.header__pagename{
    padding: 16px 10px 16px 42px;
    height: 100%;
    outline-offset: -2px;
    position: relative;
    display: block;
    font-size: 18px;
    font-weight: 600;
    margin: -1px 3px 0 13px;
}

.header__pagename span{
    position: relative;
}

.header__pagename a:hover span::before{
    width: calc(100% + 4px);
    top: calc(100% - 1px);
}

.header__pagename::before {
    border-left: 2px solid #000;
    height: 24px;
    content: " ";
    margin-left: 7px;
    position: absolute;
    top: 17px;
    left: 0;
}

.header__navigation_list{
    display: flex;
}

.header__navigation-left .navigation_list_item{
    margin-right: 4px;
}

.navigation_list_item a{
    font-size: 13px;
    color: #262626;
    display: inline-block;
    margin-top: 1px;
    padding: 18px 12px 10px 12px;
    height: 48px;
    outline-offset: -2px;
}

.navigation_list_item.has-child a{
    padding: 18px 26px 16px 15.5px;
}

.has-child span{
    position: relative;
}

.has-child span:after {
    font-family: "MWF-MDL2";
    content: "";
    position: absolute;
    font-size: 8px;
    display: inline-block;
    color: currentColor;
    font-weight: 700;
    top: 8px;
    right: calc(0% - 16px);
}

#navigation_more-list{
    display: none;
}

.header__navigation-left{
    margin-right: auto;
}

.header__search{
    position: relative;
}

.header__navigation-right .navigation_list_item a{
    padding-top: 17px;
}

.header__sign-in a{
    padding-right: 46px;
    position: relative;
}

.header__sign-in span::before{
    display: none;
}

.header__sign-in svg{
    position: absolute;
    top: 10px;
    right: 2px;
}

.header__cart a{
    position: relative;
    padding-right: 26px;
}

.header__cart a:after {
    position: absolute;
    font-family: "MWF-MDL2";
    content: "";
    display: inline-block;
    right: 5px;
    top: 17px;
    font-size: 16px;
    line-height: 16px;
}

.header__cart a:hover span:before{
    width: calc(100% + 6px);
} 

.header__search{
    margin-right: 20px;
}

.header__search a{
    padding-right: 28px;
}

.header__search a:after {
    position: absolute;
    font-family: "MWF-MDL2";
    content: "";
    display: inline-block;
    right: 7px;
    top: 20px;
    font-size: 16px;
    line-height: 16px;
}

.header__navigation-right .header__all-microsoft a{
    padding-top: 18px;
    padding-right: 24px;
}

/* Все потому-что у кнопки "Support" подчеркивание находится на пиксель ближе к тексту */
.header__support span::before{
    top: calc(100% + 1px);
}

#navigation_more-list.active{
    display: block;
}

#navigation_more-list.active button{
    font-size: 13px;
    color: #262626;
    display: inline-block;
    margin-top: 1px;
    padding: 21px 19px 16px 10px;
    height: 48px;
    outline-offset: -2px;
    background: 0;
    border: 0;
}

.header__burger-open{
    position: relative;
    width: 48px;
    height: 48px;    
    font-size: 20px;
    flex-shrink: 0;
}

.header__burger-open::after{
    position: absolute;
    content: "";
    width: 100%;
    height: 100%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-family: "MWF-MDL2";
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
}

.header__search-mobile,
.header__burger-open{
    display: none;
}

header.search .header__pagename,
header.search .header__navigation,
header.search .header__navigation,
.header__search_close-mobile,
.header__search-blk
{
    display: none;
}

header.search .header__search-blk{
    display: flex;
}

.header__search-blk{
    width: 100%;
    margin-left: 56px;
    align-items: center;
}

.header__search-group{
    width: 100%;
    position: relative;
}

.header__search_search-btn{
    font-family: "";
    font-family: "MWF-MDL2";
    width: 32px;
    height: 36px;
    font-size: 16px;
    position: absolute;
    right: 3px;
    top: 3px;
}

.header__search_input{
    padding: 7px 9px;
    padding-right: 38px;
    border: 1px solid rgba(0,0,0,.6);
    height: 36px;
    width: 100%;
    transform: translateY(3px);
    font-family: 'Segoe UI',SegoeUI,"Helvetica Neue",Helvetica,Arial,sans-serif;
}

.header__search_input::placeholder{
    transform: translateY(1px);
    font-size: 13px;
}

.header__search_input:focus,
.header__search_input:active{
    border-radius: 0;
    border: 2px solid #0067b8;
    outline: none;
}

.header__search_close{
    border: 1px solid currentColor;
    color: rgba(0,0,0,.6);
    display: block;
    height: 36px;
    margin-left: 5px;
    margin-top: 3px;
    margin-right: 34px;
    padding: 6px;
    white-space: nowrap;
    width: 80px;
    font-size: 13px;
    line-height: 26px;
    font-family: 'Segoe UI',SegoeUI,"Helvetica Neue",Helvetica,Arial,sans-serif;
}

.header__search a, .header__cart a{
    position: relative;
}

.header__search a:hover .tip,
.header__cart a:hover .tip,
.header__search a:focus .tip, 
.header__cart a:focus .tip{
    display: block;
}

.tip{
    background-color: #fff;
    border: 1px solid #ccc;
    box-shadow: 2px 2px 2px #777;
    color: #333;
    font-size: 12px;
    max-width: 328px;
    line-height: normal;
    overflow-wrap: break-word;
    position: absolute;
    width: max-content;
    display: none;
    padding: 2px;
    z-index: 99;
    top: calc(100% - 11px);
}

.tip::after, .tip::before{
    display: none;
}

.header__cart a .tip{
    left: 50px;
}

.header__search a .tip{
    right: 3px;
}

.header__pagename-mobile,
.header__burger-menu{
    display: none;
}

.header__search_search-btn:hover .tip{
    display: block;
    font-family: 'Segoe UI',SegoeUI,"Helvetica Neue",Helvetica,Arial,sans-serif;
    top: calc(100% + 1px);
    right: 3px;
}

.more-list_open-btn span{
    position: relative;
}

.more-list_open-btn span::after{
    font-family: "MWF-MDL2";
    content: "";
    position: absolute;
    font-size: 8px;
    display: inline-block;
    color: currentColor;
    font-weight: 700;
    top: 6px;
    right: calc(0% - 16px);
}


@media screen and (max-width: 1778px) {

    .header__search-blk {
        margin-left: 83px;
        margin-right: 32px;
    }

    .header__search_input{
        margin-top: -2px;
    }

    .header__search_input::placeholder{
        margin-left: 1px;
    }

    .header__search_search-btn {
        right: 4px;
        top: 1px;
    }

    header{
        padding: 0 24px;
    }

    header .wrapper{
        max-width: 1621px;
    }

    .header__logo {
        padding: 16px 6px 16px 22px;
    }

    .header__pagename {
        padding: 16px 13px 16px 28px;
        margin-right: 0;
    }

    .header__pagename::before {
        top: 16px;
    }

    .navigation_list_item.has-child a{
        padding:18px 24px 16px 10.3px;
    } 

    .navigation_list_item a{
        padding: 18px 12px 10px 3px;
    }

    .header__navigation-right .navigation_list_item a{
        padding-top: 17px;
    }

    .header__sign-in a{
        padding-right: 49px;
    }

    .header__cart a{
        padding-right: 41px;
    }

    .header__cart a:after {
        right: 19px;
        top: 17px;
    }

    .header__search {
        margin-right: 35px;
    }

    .header__search a::after{
        right: -10px;
        top: 19px;
    }

    .header__all-microsoft{
        margin-right: 5px;
    }

    .navigation_list_item.header__all-microsoft a{
        padding-top: 18px;
    }

    .header__sign-in svg {
        top: 10px;
        right: 5px;
    }

    .header__cart a .tip {
        left: -14px;
    }

    .header__search a .tip {
        right: -12px;
    }
}

@media screen and (max-width: 1399px) {
    header{
        padding: 0 5%;
    }

    header .wrapper {
        max-width: 1257px;
    }

    .header__logo{
        padding: 16px 7px 16px 10px;
    }

    .header__pagename {
        padding: 16px 11px 16px 28px;
    }

    .header__pagename::before {
        top: 16px;
        left: -1;
    }

    .header__cart span:first-child, 
    .header__search span:first-child, 
    .header__sign-in span:first-child{
        display: none;
    }

    .navigation_list_item a{   
        padding: 19px 12px 10px 5px;
    }

    .header__sign-in a {
        padding-right: 25px;
    }

    .header__navigation-left .navigation_list_item {
        margin-right: 1.3px;
    }

    .header__navigation-left .navigation_list_item a{
        padding-right: 27px;
    }

    .header__cart{
        margin-right: 13px;
    }

    .header__cart a {
        padding-right: 25px;
    }

    .header__cart a:after {
        right: 6px;
        top: 16px;
    }

    .header__search {
        margin-right: 7px;
    }

    .header__search a{
        padding-right: 25px;
    }

    .header__search a::after {
        right: 6px;
    }
    
    .header__all-microsoft{
        margin-right: 8px;
    }

    .header__sign-in svg {
        top: 10px;
        right: -2px;
    }

    .header__cart a .tip {
        left: -81px;
    }

    .header__search a .tip {
        top: calc(100% - 10px);
    }

    
    .navigation_list_item.has-child a {
        padding-right: 27px;
    }

    .header__search-blk {
        margin-left: 44px;
        margin-right: -13px;
    }

    .header__search_close{
        width: 82px;
    }

}

@media screen and (max-width: 1083px) {
    header{
        padding: 0 24px;
    } 

    header .wrapper{
        padding-top: 0;
    }

    .header__logo {
        padding: 16px 7px 16px 10px;
    }

    .header__pagename {
        padding: 16px 11px 16px 28px;
    }

    .header__pagename::before {
        top: 16px;
    }

    #navigation_more-list.active button {
        font-size: 13px;
        color: #262626;
        display: inline-block;
        margin-top: 1px;
        padding: 20px 19px 16px 10px;
    }

    .navigation_list_item.has-child a {
        padding: 18px 24px 16px 10.2px;
    }

    .header__sign-in {
        margin-right: 0px;
    }

    .header__cart a {
        padding-right: 23px;
    }

    .header__sign-in a {
        padding-right: 31px;
    }

    .header__sign-in svg {
        right: 4px;
    }

    .header__search a::after {
        right: 7px;
        top: 19px;
    }

    .header__all-microsoft {
        margin-right: 9px;
    }

    .header__cart a:after {
        right: 6px;
        top: 16px;
    }

    .header__cart a .tip {
        left: -103px;
    }
}

@media screen and (max-width: 859px){
    .tip{
        display: none;
    }

    header .wrapper{
        padding-top: 0;
    }

    header.search .header__logo,
    header.search .header__search-mobile,
    header.search .header__burger-open,
    .header__search_close
    {
        display: none;
    }

    .header__search_close-mobile{
        display: block;
        width: 48px;
        height: 48px;
        font-size: 15px;
        font-family: "MWF-MDL2";
        margin-top: 0px;
    }

    .header__burger-open{
        display: block;
    }

    .header__search-blk{
        margin: 3px 13px 3px 1px;
    }

    .header__search_input{
        transform: translateY(0px);
        margin-left: 3px;
        padding: 7px 9px;
        padding-left: 40px;
        padding-right: 10px;
        font-size: 15px ;
        height: 35px;
    }

    .header__search_input::placeholder{
        font-size: 15px;
        font-family: 'Segoe UI',SegoeUI,"Helvetica Neue",Helvetica,Arial,sans-serif;
        transform: translateY(1px);
    }

    .header__search_search-btn{
        right: unset;
        left: 4px;
        top:0;
    }

    .header__pagename,
    .header__search,
    .header__navigation-left,
    .header__all-microsoft{
        display: none;
    }

    header{
        padding: 0;
    }

    header .wrapper{
        align-items: center;
    }

    .header__logo{
        margin: 0 auto;
        padding-left: 28px;
        padding-top: 16px;
        padding-bottom: 14px;
    }

    .header__burger-open{
        margin-right: 0px;
        transform: translate(1px,-1px);
    }

    .header__search-mobile{
        display: block;
        font-family: "MWF-MDL2";
        width: 32px;
        height: 32px;
        font-size: 16px;
        margin-left: 3px;
        margin-top: 2px;
    }

    .header__sign-in{
        margin-right: 15px;
        transform: translateY(2px);
    }

    .header__sign-in svg{
        position: relative;
        left: 0;
        top: 0;
    }

    .header__cart a::after{
        top: 10px;
    }

    .header__cart{
        margin-right: 24px;
        transform: translateY(-1px);
    }

    .header__sign-in a, 
    .header__cart a{
        padding: 0;
        width: 32px;
        height: 32px;
        flex-shrink: 0;
    }

    .header__navigation-right .navigation_list_item a {
        padding-top: unset;
    }

    .header__pagename-mobile{
        display: block;
        width: 100%;
        background: #fff;
        display: flex;
        align-items: center;
        border-bottom: 1px solid #e6e6e6;
        border-top: 1px solid #e6e6e6;
        padding-top: 7px;
        padding-bottom: 6px;
    }

    .header__pagename-mobile_text{
        display: block;
        font-weight: 600;
        height: 100%;
        padding: 0 11px 0 16px;
        text-align: left;    
        font-size: 15px;
        font-family: 'Segoe UI',SegoeUI,"Helvetica Neue",Helvetica,Arial,sans-serif;
    }

    .header__pagename-mobile_ico{
        font-family: "MWF-MDL2";
        font-size: 12px;
        margin-top: 4px;
    
    }

    header.burger-opened .header__pagename-mobile{
        display: none;
    }

    header.burger-opened .header__burger-menu{
        display: flex;
        width: 100%;
        background: #f2f2f2;
        padding-top: 5px;
    }

    .burger-menu_list{
        width: 100%;
    }

    .header__burger-open.active:after{
        content: "";
    }

    .burger-menu_item a{
        padding: 14px 15px 19px;
        width: 100%;
        padding-right: 24px;
        margin-left: 1px;
        display: block;
        color: #262626;    
        font-size: 15px;
        font-family: 'Segoe UI',SegoeUI,"Helvetica Neue",Helvetica,Arial,sans-serif;
        border-bottom: 1px solid #e6e6e6;
        position: relative;
    }

    .burger-menu_item:last-child a{
        border-bottom: 1px solid #000;
    }

    .burger-menu_item.has-child a::after{
        font-family: "MWF-MDL2";
        content: "";
        font-size: 9px;
        font-weight: 700;
        position: absolute;
        right: 22px;
        top: 21px;
    }

    
}
</style>

<script>

    const leftNav = document.querySelector(".header__navigation-left");
    const rightNav = document.querySelector(".header__navigation-right");
    const blockContainer = document.querySelector(".more-list_container");
    const moreList = document.querySelector("#navigation_more-list")

    const distancebetween =  80;

    function getDistanceBetween(left, right){
        let leftRightCornerCoords = Number(getComputedStyle(left).width.slice(0,-2)) + left.getBoundingClientRect().x;
        let rightRightCornerCoords = right.getBoundingClientRect().x;

        return rightRightCornerCoords - leftRightCornerCoords;
    }

    function updateNav(){
        let distance = getDistanceBetween(leftNav, rightNav);
        
        // Если дистанция маленькая, то убираем элементы
        if(distance <= distancebetween){
            let elemContainer = leftNav.querySelector(".header__navigation_list");
            let elemList  = elemContainer.children;

            if(elemList.length > 1){
                let lastElem = elemList[elemList.length-2];
                let lastElemWidth = getComputedStyle(lastElem).width.slice(0,-2)
                
                elemContainer.removeChild(lastElem);
                lastElem.setAttribute("w", Math.floor(lastElemWidth));
                blockContainer.appendChild(lastElem);
                lastElem = elemList[elemList.length-2];
            }
            
        }
        // Если дистанции достаточно, то возвращаем из обратно
        else if(distance > distancebetween){
            let blockContainerChilds = blockContainer.children;

            if(blockContainerChilds.length>0){
                let blockContainerLast = blockContainerChilds[blockContainerChilds.length-1];
                let navigationBlock = leftNav.querySelector(".header__navigation_list");

                if(Number(blockContainerLast.getAttribute("w")) + distancebetween < (distance)){
                    let elemContainer = leftNav.querySelector(".header__navigation_list");

                    blockContainer.removeChild(blockContainerLast);
                    blockContainerLast.removeAttribute("w");
                    navigationBlock.insertBefore(blockContainerLast,moreList);
                }
            }

            
        }
    
        blockContainer.innerHTML != "" ? moreList.classList.add("active") : moreList.classList.remove("active");
    }


    window.addEventListener("resize", ()=>{
        updateNav();
    })

    window.addEventListener("DOMContentLoaded", ()=>{
        let listItemsAmount =  leftNav.querySelectorAll(".navigation_list_item");
        listItemsAmount.forEach(()=>{
            updateNav();
        })

    })


    const searchOpen = document.querySelectorAll(".header__search-mobile, .header__search");
    const header = document.querySelector("header");
    const searchClose = document.querySelectorAll(".header__search_close, .header__search_close-mobile")

    // Открытие поиска
    searchOpen.forEach((el)=>{
        el.addEventListener("click", ()=>{
            header.classList.add("search");
        })
    })

    // Закрытие поиска
    searchClose.forEach((el)=>{
        el.addEventListener("click", ()=>{
            header.classList.remove("search");
        })
    })

    // Закрытие поиска при клике вне его блока
    // Проверяем есть ли в пути блока класс header__search-blk
    // И, если нету, то убираем класс с хедера (закрываем поиск)
    function CheckClass(el, Class){
        return el.classList != undefined ? el.classList.contains(Class) : false;
    }

    document.addEventListener("click", (e)=>{
        if(header.classList.contains("search")){

            e.path.some((el)=>{
               return CheckClass(el, "header__search-blk")
            }) || 
            e.path.some((el)=>{
               return CheckClass(el, "header__search")
            }) 
            || 
            e.path.some((el)=>{
               return CheckClass(el, "header__search-mobile")
            }) 
            ? console.log("open") : header.classList.remove("search");

            

        }
    })
    
    const burgerBtn = document.querySelector(".header__burger-open")
    
    burgerBtn.addEventListener("click", ()=>{
        header.classList.contains("burger-opened") ? header.classList.remove("burger-opened") : header.classList.add("burger-opened")
        header.classList.contains("burger-opened") ? burgerBtn.classList.add("active") : burgerBtn.classList.remove("active")
    })
    

</script>